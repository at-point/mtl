# MTL: Materializer

Materializer is an opinionated toolkit for Rails to simplify building user
interfaces that are based on [Material Design][material] and
[Materialize CSS][materialize].

## Using MTL

MTL provides three different parts:

- [Materialize CSS][materialize] and extensions for the asset pipeline,
- [Materialize][materialize] JS wrappers for the asset pipeline (and support turbolinks),
- and Rails view helpers to render common components

The first step is to add `mtl` to your `Gemfile`:

```ruby
gem 'mtl', git: 'https://github.com/at-point/mtl'
```

Then run `bundle` and then afterwards the install generator to copy customizable
assets to your project:

```
./bin/rails generate mtl:install [--skip-simple-form]
# This copies the following files:
#    - app/assets/stylesheets/mtl.scss
#    - app/assets/stylesheets/mtl/_color.scss
#    - app/assets/stylesheets/mtl/_variables.scss
#    - config/initializers/simple_form.rb
```

Last but not least change your `application.css` to include:

```
//= require mtl
```

## Layouts

MTL provides two layouts:

- a default application layout, with a header and a sidebar ![default layout](../docs/layout-default.jpg)
- a single layout with centered content ![single layout](../docs/layout-single.jpg)


### Default application Layout

This layout is suited for standard application / backends with a sidebar for
the primary navigation.

```html
<body class="mtl-layout-default">
  <header id="nav-menu" class="side-nav fixed">
    <!-- your nav collection -->
  </header>
  <main>
    <%= mtl_header 'Dashboard' %>
    <div class="mtl-layout-default-content">
      <!-- your content -->
    </div>
  </main>
</body>
```

### Single Layout

A centered single column layout, e.g. for login screens or other standalone
views.

**TODO: @marco, can we align the markup structure between mtl-layout-default and this**

```html
<body class="mtl-layout-single">
  <header class="mtl-layout-single-header">
  </header>
  <main class="mtl-layout-single-content">
    <!-- your content, e.g. a card: -->
    <div class="row">
      <div class="col s12 m8 offset-m2">
        <div class="card">
          <!-- ... -->
        </div>
      </div>
    </div>
  </main>
</body>
```

## JavaScript

MTL provides unobstrusive wrappers that work with (and without) Rails' Turbolinks.
To get started add the following sprockets require to your primary JS file:

```js
//= require mtl
```

When you are using Turbolinks, this require statement must be added after
turbolinks.

### Supported Features

The following JS helpers from [Materialize CSS][materialize] are supported:

- Wave effects (enabled for Turbolinks)
- Text fields (support for Turbolinks)
- Mobile navigation: `data-mtl-nav`
- Select fields: `data-mtl-select`

**Note:** at the time of writing not all JS helpers are supported. New wrappers
are added step by step over time.

### Mobile navigation

For elements that use `data-mtl-nav="side"`, like those generated by the
{Mtl::Rails::ViewHelpers#mtl_header mtl_header}, the `sideNav()` method is
automatically executed.

![Mobile Nav Example](images/mobile_nav.jpg)

**Example markup**

```html
<div class="side-nav" id="nav">
  <!-- side nav -->
</div>
<nav>
  <a class="left hide-on-large-only" data-activates="nav" data-mtl-nav="side" href="#nav">
    <i class="material-icons">menu</i>
  </a>
  <h1 class="page-title">My Account</h1>
</nav>
```

### Select fields

Supports handling and styling of Material CSS [select form fields][m-select], one
option is also a multi select drop down.

#### Single select

![Single select](images/select.gif)

```html
<select data-mtl-select>
  <option value="" disabled selected>Choose your option</option>
  <option value="1">Option 1</option>
  <option value="2">Option 2</option>
  <option value="3">Option 3</option>
</select>
```

#### Multi select

The first option acts as a _all_ option, that is correctly selected, deselected
and reselected based on user input.

![Single select](images/select_multi.gif)

```html
<select data-mtl-select="multiple" multiple>
  <option value="all"selected>All</option>
  <option value="1">Option 1</option>
  <option value="2">Option 2</option>
  <option value="3">Option 3</option>
</select>
```

### Collapsible

Adds support for the [collapsibles from Materialize CSS][m-collapsible] within
Turbolinks and adds a special addition: the `data-mtl-collapsible-toggle`.

![Collapsible](images/collapse.gif)

#### Accordion

The markup is exactly the same, except for `data-mtl-collapsible="accordion"`,
instead of `data-collapsible="accordion"`, this is required to support turbolinks
and because Materialize CSS binds directly to the `.collapsible` class.

```html
<ul class="collapsible" data-mtl-collapsible="accordion">
```

#### Expandable

Like for the accordion, the markup remains the same, simply use
`data-mtl-collapsible="expandable"`.

```html
<ul class="collapsible" data-mtl-collapsible="expandable">
```

#### Toggle

This allows to have an external trigger to toggle between the first and last
element of a `<ul class="collapsible">`. The required markup is as follows:

![Collapsible](images/collapse_toggle.gif)

The trigger element receives the class `.active` when the last element is shown
and `.active` is removed otherwise. As usual an item can be pre-opened with
adding the class `.active` to the corresponding `.collapsible-header` element,
by default the first item is open.

```html
<!-- Reference the .collapsible you want to toggle. -->
<div data-mtl-collapsible-toggle="#menu">Trigger</div>

<!-- Clicking on "Trigger" toggles between the App Menu Options and the
     User Menu Options. The headers are hidden. -->
<ul class="collapsible" id="menu">
  <li>
    <div class="collapsible-header">App</div>
    <div class="collapsible-body">
      ...App Menu Options
    </div>
  </li>
  <li>
    <div class="collapsible-header">User</div>
    <div class="collapsible-body">
      ...User Menu Options
    </div>    
  </li>
</ul>
```

### `data-mtl-href` Utility

This utility helps linking rows from a table or ul to open a detail page.

```html
<tr data-mtl-href="<%= user_path(@user) %>">
  <td><img ...></td>
  <td><%= @user.first_name %></td>
  <td><%= @user.last_name %></td>
  <td><%= mail_to @user.email %></td>
  <td>
    <%= mtl_button_flat "Delete", user_path(@user), method: 'delete' %>
  </td>
</tr>
```

[material]: https://material.google.com/
[materialize]: http://materializecss.com/
[icons]: https://design.google.com/icons/

[m-select]: http://materializecss.com/forms.html#select
[m-collapsible]: http://materializecss.com/collapsible.html
